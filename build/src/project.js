window.__require=function i(t,n,e){function s(o,c){if(!n[o]){if(!t[o]){var r=o.split("/");if(r=r[r.length-1],!t[r]){var h="function"==typeof __require&&__require;if(!c&&h)return h(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+o+"'")}}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(i){return s(t[o][1][i]||i)},u,u.exports,i,t,n,e)}return n[o].exports}for(var a="function"==typeof __require&&__require,o=0;o<e.length;o++)s(e[o]);return s}({anim:[function(i,t,n){"use strict";cc._RF.push(t,"799a4xLBHRLq7Kj9a2fTp/y","anim");t.exports=function(i,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},e=t.getComponent(cc.Sprite),s=t.addComponent(cc.Animation),a=0;return i.forEach(function(t){cc.loader.loadResDir(t,cc.SpriteFrame,function(o,c){e.spriteFrame=c[0];var r=cc.AnimationClip.createWithSpriteFrames(c,8);r.name=t,r.wrapMode=cc.WrapMode.Loop,s.addClip(r),++a===i.length&&n()})}),s},cc._RF.pop()},{}],"frame-action":[function(i,t,n){"use strict";cc._RF.push(t,"75482+WGJtICoDc6STdwLjk","frame-action");var e=function(i){this.opts=i,this.node=i.parent,this.onPlay=i.onPlay,this.onFinished=i.onFinished,this.createAction(i)};e.prototype={createAction:function(i){var t=this,n=i.play,e=i.action,s=i.view,a=i.parent,o=new cc.Node;o.name="actions",o.parent=a;var c=o.addComponent(cc.Sprite),r=o.addComponent(cc.Animation);cc.loader.loadResDir(n+"/"+e+"/"+s,cc.SpriteFrame,function(i,n){var e=n;c.spriteFrame=e[0];var s=cc.AnimationClip.createWithSpriteFrames(e,8);s.name="anim_action",s.wrapMode=cc.WrapMode.Normal,r.addClip(s),r.play("anim_action"),r.on("play",t._onPlay,t),r.on("finished",t._onFinished,t)}),this.actionsNode=o},removeAniNode:function(){this.actionsNode.removeFromParent()},_onPlay:function(){console.log("_play"),this.onPlay&&this.onPlay()},_onFinished:function(){console.log("_onFinished"),this.removeAniNode(),this.onFinished&&this.onFinished()}},t.exports=e,cc._RF.pop()},{}],game:[function(i,t,n){"use strict";cc._RF.push(t,"c230fsafcFJlJ2OmgyMYqBy","game"),cc.Class({extends:cc.Component,properties:{ground:{default:null,type:cc.Node},hero:{default:null,type:cc.Node},punkPrefab:{default:null,type:cc.Prefab},minX:0,maxX:0,minY:0,maxY:0},onLoad:function(){this.getXYSpan(),this.newPunk()},getXYSpan:function(){var i=this.ground,t=i.height,n=i.y;this.minX=-cc.winSize.width/2,this.maxX=-this.minX,this.minY=n-t,this.maxY=n},newPunk:function(){var i=cc.instantiate(this.punkPrefab),t=this.getPunkPos();this.node.addChild(i),i.setPosition.apply(i,function(i){if(Array.isArray(i)){for(var t=0,n=Array(i.length);t<i.length;t++)n[t]=i[t];return n}return Array.from(i)}(t))},getPunkPos:function(){var i=Math.random();return[this.hero.x>0?this.minX:this.maxX,(this.maxY-this.minY)*i+this.minY]}}),cc._RF.pop()},{}],hero:[function(i,t,n){"use strict";cc._RF.push(t,"02842c1oZxJ3bu715Qv0lMl","hero");var e=i("./utils/anim.js");cc.Class({extends:cc.Component,properties:{parent:null,move:"",walking:!1,fisting:!1,kicking:!1,anim:null,game:null,speedX:140,speedY:70},onLoad:function(){this.game=this.node.parent.getComponent("game"),this.node.zIndex=10,this.loadAnim(),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},update:function(i){this.heroMove(i)},loadAnim:function(){var i=this;this.anim=e(["hero-fist","hero-kick","hero-walk"],this.node,function(){i.stand(),i.walking=!1})},heroMove:function(i){switch(this.move){case"":break;case"right":if(this.node.rotationY=0,this.node.x>=this.game.maxX)return;if(this.fisting||this.kicking)return;this.node.x+=this.speedX*i;break;case"left":if(this.node.rotationY=180,this.node.x<=this.game.minX)return;if(this.fisting||this.kicking)return;this.node.x-=this.speedX*i;break;case"up":if(this.node.y>=this.game.maxY)return;if(this.fisting||this.kicking)return;this.node.y+=this.speedY*i;break;case"down":if(this.node.y<=this.game.minY)return;if(this.fisting||this.kicking)return;this.node.y-=this.speedY*i}},onKeyDown:function(){switch(event.keyCode){case cc.macro.KEY.a:this.move="left",this.walk();break;case cc.macro.KEY.d:this.move="right",this.walk();break;case cc.macro.KEY.s:this.move="down",this.walk();break;case cc.macro.KEY.w:this.move="up",this.walk();break;case cc.macro.KEY.j:this.kick();break;case cc.macro.KEY.k:this.fist()}},onKeyUp:function(){switch(event.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.d:case cc.macro.KEY.s:case cc.macro.KEY.w:this.move="",this.walking=!1,this.anim.stop("hero-walk");break;case cc.macro.KEY.j:this.kicking=!1,this.anim.stop("hero-kick"),this.stand();break;case cc.macro.KEY.k:this.fisting=!1,this.anim.stop("hero-fist"),this.stand()}},walk:function(){this.walking||this.fisting||this.kicking||(this.anim.play("hero-walk"),this.walking=!0)},kick:function(){this.kicking||(this.kicking=!0,this.anim.play("hero-kick"))},fist:function(){this.fisting||(this.fisting=!0,this.anim.play("hero-fist"))},stand:function(){var i=this;this.anim.play("hero-walk"),setTimeout(function(){i.anim.stop("hero-walk")},100)}}),cc._RF.pop()},{"./utils/anim.js":"anim"}],punk:[function(i,t,n){"use strict";cc._RF.push(t,"eaccbBWfHJG+YIWMvRWP1i4","punk");var e=i("./utils/anim.js");cc.Class({extends:cc.Component,properties:function(i,t,n){return t in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n,i}({ready:!1,status:"stand",radius:50,face:"r",head:"u",anim:null,speedX:50,speedY:25,hero:null},"anim",null),onLoad:function(){this.status="stand",this.hero=this.node.parent.getChildByName("hero"),this.loadAnim()},update:function(i){this.approachHero(i)},loadAnim:function(){var i=this;this.anim=e(["punk-pant","punk-hurt","punk-fall","punk-walk"],this.node,function(){i.stand(),i.ready=!0})},approachHero:function(i){if(this.ready){var t=this.node.y-this.hero.y,n=Math.abs(t);if(this.head=t<0?"u":"d",this.node.zIndex="u"===this.head?this.hero.zIndex+1:this.hero.zIndex-1,["walk","stand"].includes(this.status)){var e=this.node.x-this.hero.x,s=Math.abs(e);this.face=e<0?"r":"l",this.node.rotationY="r"===this.face?0:180,this.walkingX(i,s),this.walkingY(i,s,n),s<50&&n<10?this.stand():this.walk()}}},walkingX:function(i,t){if(!(t<50)){var n=t<this.speedX?t:this.speedX;"r"===this.face?this.node.x+=n*i:this.node.x-=n*i}},walkingY:function(i,t,n){if(!(t>150)){var e=n<this.speedY?n:this.speedY;"u"===this.head?this.node.y+=e*i:this.node.y-=e*i}},walk:function(){"walk"!==this.status&&(this.anim.play("punk-walk"),this.status="walk")},stand:function(){var i=this;this.anim.play("punk-walk"),setTimeout(function(){i.anim.stop("punk-walk"),i.status="stand"},100)}}),cc._RF.pop()},{"./utils/anim.js":"anim"}]},{},["game","hero","punk","anim","frame-action"]);